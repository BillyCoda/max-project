import { Injectable } from '@angular/core';
import { Ingredient } from '../shared/ingredient.model';
import { ShoppingListService } from '../shopping-list/shopping-list.service';
import { Recipe } from './recipe.model';
import { Subject } from 'rxjs';

@Injectable()
export class RecipeService {
  recipesChanged = new Subject<Recipe[]>();

  private recipes: Recipe[] = [
    new Recipe(
      'Chicken Parm',
      'Parm with chicken',
      'https://upload.wikimedia.org/wikipedia/commons/2/29/Chickensilhouette.png',
      [
        new Ingredient('Chicken', 1),
        new Ingredient('Parmesan', 2)
      ]
    ),
    new Recipe(
      'Tacos',
      'Uhm ... just tacos',
      // tslint:disable-next-line: max-line-length
      'data:image/png;base64,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',
      [
        new Ingredient('Tortillas', 2),
        new Ingredient('Meat', 4),
        new Ingredient('Salsa', 6)
      ]
    )
  ];

  constructor(private shopService: ShoppingListService) {}

  public setRecipes(recipes: Recipe[]) {
    this.recipes = recipes;
    this.recipesChanged.next(this.recipes.slice());
  }

  public getRecipes() {
    return this.recipes.slice();
  }

  getRecipe(id: number) {
    return this.recipes[id];
  }

  public addIngredientsToShoppingList(ingredients: Ingredient[]) {
    this.shopService.addIngredients(ingredients);
  }

  public addRecipe(recipe: Recipe) {
    this.recipes.push(recipe);
    this.recipesChanged.next(this.recipes.slice());
  }

  public updateRecipe(index: number, newRecipe: Recipe) {
    this.recipes[index] = newRecipe;
    this.recipesChanged.next(this.recipes.slice());
  }

  public deleteRecipe(index: number) {
    this.recipes.splice(index, 1);
    this.recipesChanged.next(this.recipes.slice());
  }
}
